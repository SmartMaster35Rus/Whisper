# Подробная документация по скрипту обработки аудиофайлов с использованием Whisper

## Введение

Этот скрипт предназначен для обработки аудиофайлов в формате `.ogg`, автоматической транскрипции в текст с помощью модели Whisper и сохранения результатов в текстовые файлы. Скрипт обрабатывает файлы в указанной директории и всех её поддиректориях.

## Используемые библиотеки и их функции

- `torch`

Библиотека для машинного обучения, использующаяся для работы с нейронными сетями.

- `transformers`

Библиотека от Hugging Face, предоставляющая инструменты для работы с предобученными моделями NLP.

- `pydub`

Библиотека для манипуляций с аудиофайлами, включая конвертацию форматов.

- `time`

Стандартная библиотека Python для работы со временем, используется для измерения времени выполнения скрипта.

- `os`

Стандартная библиотека Python для взаимодействия с операционной системой, используется для работы с файлами и директориями.

- `tqdm`

Библиотека для создания индикаторов прогресса в командной строке.

## Функции и методы

### Функция `process_files`

#### Аргументы

- `files`: список строк, содержащих пути к файлам для обработки.
- `output_dir`: строка, путь к директории для сохранения результатов.

#### Описание

Функция принимает список файлов, конвертирует каждый из `.ogg` в `.wav`, транскрибирует его с помощью модели Whisper и сохраняет текстовый результат в указанную директорию.

### Инициализация модели Whisper

#### Модель `openai/whisper-large-v3`

##### Описание

Модель для транскрипции аудио, предобученная и оптимизированная для различных языков и акцентов.

#### Параметры пайплайна

- `automatic-speech-recognition`: тип задачи, указывающий, что пайплайн будет использоваться для распознавания речи.
- `model`: экземпляр модели, загруженный из Hugging Face.
- `tokenizer`: компонент для токенизации текста, используемый моделью.
- `feature_extractor`: компонент для извлечения акустических признаков из аудио.
- `max_new_tokens`: максимальное количество токенов, которые модель может сгенерировать в ответ на входные данные.
- `chunk_length_s`: длина отрезка аудио в секундах, которую модель обрабатывает за один раз.
- `batch_size`: количество файлов, обрабатываемых за одну итерацию.
- `return_timestamps`: флаг, указывающий на необходимость возвращать временные метки для каждого слова.
- `device`: устройство, на котором выполняются вычисления (например, GPU).

## Процесс работы

1. Запрос пути к директории с файлами.
2. Создание директории для сохранения результатов.
3. Сбор всех `.ogg` файлов в директории и поддиректориях.
4. Инициализация и конфигурация модели Whisper.
5. Пакетная обработка файлов.
6. Вывод статистики по времени выполнения и количеству обработанных файлов.

## Заключение

Данный скрипт обеспечивает комплексное решение для автоматической транскрипции аудиофайлов, позволяя обрабатывать большие объемы данных с высокой точностью и эффективностью.
